# Relatório de Execução: RDM1603638 (Produção - Econsig)
- **Projeto:** Migração Tecnológica e Modernização do Sistema Econsig - Ambiente PRD (Dedicado)
- **Estratégia:** Migração Sequencial em Servidores Dedicados (Sem Balanceamento Externo)

> **Nota de Governança:** Esta atividade segue os padrões de sucesso validados em DEV/HML dos Portais do SIGPEC. Diferente dos portais, o ambiente **Econsig** opera em servidores dedicados onde a distribuição de carga é gerenciada internamente pela aplicação, exigindo coordenação direta entre os nós.
>
> Os nomes técnicos (hostnames), endereçamentos IP e ativos específicos dos servidores dedicados estão vinculados eletronicamente a esta RDM.

---

## Objetivo
Realizar a migração da infraestrutura dedicada do sistema **Econsig** para a plataforma **RHEL 10 + Podman**, garantindo a atualização do S.O. e a otimização dos containers em um ambiente de alta performance.

---

## Atividade

### 1. Evolução da Infraestrutura (S.O. e Engine)
* **Upgrade de Sistema:** Salto tecnológico do RHEL 8 para o **RHEL 10**, assegurando conformidade com as bibliotecas mais recentes e estendendo o ciclo de vida do ambiente.
* **Transição para Podman:** Substituição do Docker pela engine **Podman**, implementando uma arquitetura *daemonless* e integração nativa com o ecossistema Red Hat.

### 2. Otimização e Gestão de Containers (Debian Slim)
Migração da base dos containers para **Debian Bullseye Slim**, proporcionando um ambiente mais enxuto e seguro em comparação ao antigo padrão CentOS. As **5 instâncias isoladas** foram configuradas como serviços nativos (**Systemd**), garantindo resiliência e alta disponibilidade:

* **Eficiência Operacional:** Adoção de imagens *Slim*, reduzindo o tamanho das imagens e minimizando a superfície de ataque.
* **Estabilidade:** Utilização de repositórios estáveis do Debian, garantindo compatibilidade total com o JDK 8 e Tomcat 9.
* **Serviços Migrados:**
    * **`sigpec-esocial-ws`**: Web Service de Transmissão eSocial.

### 3. Modernização da Camada de Proxy (Apache HTTPD)
Refatoração completa dos *Virtual Hosts* com foco em performance e segurança:
* **Padronização 2.4:** Migração para diretivas de controle de acesso modernas (`Require all granted`).
* **Eficiência de Rede:** Otimização de `RewriteRules` para redirecionamentos internos, eliminando latências de resolução de DNS.
* **Sustentação de Carga:** Configuração de `Timeouts` estendidos (900s) para garantir o sucesso em operações complexas do eSocial e Barramento.

### 4. Hardening e Segurança (SELinux)
Aplicação de políticas restritivas para garantir a integridade do servidor:
* **Contextos de Unidade:** Re-rotulagem de segurança dos arquivos de serviço via `restorecon` para integração perfeita com o Systemd.
* **Network Policies:** Liberação granular de permissões (`httpd_can_network_connect` e `httpd_can_network_connect_db`), viabilizando a comunicação segura entre Proxy, Containers e o Banco de Dados **Oracle**.

---

## Cronograma de Execução Técnica

### Fase 1: Modernização do Servidor Dedicado 01
1. **Provisionamento:** Instalação do **RHEL 10** e configuração do **Podman** no primeiro servidor dedicado.
2. **Deploy e Configuração:** Implementação do container Econsig (Debian Slim) e ajuste do Apache Proxy com timeouts de 900s.
3. **Migração de Atividades:** Transferência das rotinas e processamentos para o novo Servidor 01, validando a estabilidade operacional.

### Fase 2: Modernização do Servidor Dedicado 02
1. **Provisionamento:** Após a estabilização do primeiro nó, iniciou-se a migração do segundo servidor dedicado para **RHEL 10**.
2. **Replicação Técnica:** Configuração idêntica de containers e políticas de segurança (**SELinux/Hardening**), mantendo a paridade entre os servidores.
3. **Sincronismo de Aplicação:** Reestabelecimento da comunicação e distribuição de tarefas entre os dois servidores dedicados conforme a arquitetura interna do Econsig.

---

## Diferenciais Técnicos da Migração

* **Ambiente Dedicado:** Configuração otimizada para o processamento exclusivo do Econsig, sem concorrência de recursos com outros portais.
* **Gestão via Systemd:** Implementação de unidades de serviço para garantir que a aplicação inicie de forma ordenada em ambos os servidores após reinicializações.
* **Hardening SELinux:** Liberação de permissões específicas para que os containers nos servidores dedicados acessem as bases de dados e diretórios de rede necessários.

---

## Resultados Alcançados
* **Estabilidade:** Ambiente 100% operacional e resiliente a reinicializações (Autostart).
* **Observabilidade:** Logs centralizados via `Journald`, facilitando o troubleshooting e auditoria.
* **Estabilização de Infraestrutura:** Transição para RHEL 10 concluída com sucesso em ambos os servidores dedicados.
* **Integridade de Dados:** Processamentos e distribuições de carga internos reestabelecidos sem perda de pacotes ou falhas de sincronismo.
* **Segurança Reforçada:** Implementação de imagens Debian Slim, reduzindo vulnerabilidades no ambiente de produção do Econsig.
